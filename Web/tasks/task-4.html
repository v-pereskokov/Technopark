<!DOCTYPE HTML>
<html lang="ru">
<head>
    <title>ДЗ 4 - Web-технологии</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/bootstrap.min.css">
</head>
<body>
    <div class="container">

        <h1 class="text-center">Домашнее задание 4</h1>
        <h2 class="text-center">Проектирование модели данных</h2>

        <p>Целью домашнего задания является проектирование модели базы данных, наполнение ее тестовыми данными и и отображение этих данных на сайте. Таким образом будет создана read-only версия сайта.</p>

        <h2>1. Проектирование модели</h2>
        <p>Используя Django Models спроектировать схему вашего приложения. Создать модели для основных сущностей:  вопрос, ответ, тэг, профиль пользователя, лайк. Важно использовать правильные типы данных и проставить необходимые связи (<a href="https://docs.djangoproject.com/en/1.10/ref/models/fields/#foreignkey" target="_blank">ForeignKey</a>) в моделях.  Для вопросов создать свой Model Manager, в котором определить типичные выборки (“лучшие” и “новые” вопросы).</p>
        <p>Поскольку мы будем использовать встроенную авторизацию Django (<b>django.contrib.auth</b>) - у нас будет готовая модель пользователя (<b>django.contrib.auth.models.User</b>), но необходимо создать дополнительную модель (Profile) в которую разместить дополнительные поля, например avatar. Модель Profile и User должны быть связаны один к одному.</p>

        <h2>2. ModelManager и методы моделей</h2>
        <p>В коде view не должно быть кода бизнесс логики (анти-паттерн fat controller). Все методы по выборке и сортировке данных - в ModelManager.  Вся логика по выводу данных, например построение полного пути к вопросу - в методы модели. Пагинация - в отдельную функцию. Вьюшки должны состоять из 4-6 строк.</p>

        <h2>3. Наполнение данными</h2>
        <p>Для удобства дальнейшей разработки нужно наполнить базу тестовыми данными. Для этого нужно создать скрипт (а лучше это сделать в виде команды приложения - Management Command), в котором добавить необходимые объекты в базу. При добавлении удобно использовать уже созданные модели, а не писать сырой SQL.</p>
        <p>Обратите внимание, что при указании связи в моделях можно использовать как id, так и объекты на которые вы ссылаетесь:</p>
        <pre><code>
        u = User.objects.get(pk=1)
        q = Question(author=u, text='wut?')  # ссылка на объект
        q.save()
        a = Answer(question_id=1, text='blabla') # ссылка по id
        a.save()
        </code></pre>
        <p>В базе данных в любом случае будут хранится поля вида author_id и question_id.</p>

        <h2>4. Отображение данных</h2>
        <div>Разработать view для отображения следующих страниц:</div>
        <ul>
            <li>Список новых вопросов</li>
            <li>Список “лучших” вопросов</li>
            <li>Список вопросов по тэгу</li>
            <li>Страница 1 вопроса со списком ответо</li>
        </ul>

        <p>Для страниц не существующих объектов нужно возвращать 404 страницу. В коде view (контроллеров) не должно быть дублирующегося кода. Использовать функцию пагинации созданную на предыдущем занятии.</p>

        <h2>5. Полезные ссылки</h2>
        <ul>
            <li><a target="_blank" href="https://docs.djangoproject.com/en/1.10/intro/tutorial02/">Туториал по проектированию моделей в Django</a></li>
            <li><a target="_blank" href="https://docs.djangoproject.com/en/1.10/topics/db/models/">Подробная документация по моделям</a></li>
            <li><a target="_blank" href="https://docs.djangoproject.com/en/1.10/howto/custom-management-commands/">Скрипты - Management Commands</a></li>
        </ul>
    </div>
</body>
</html>
